<!DOCTYPE html>
<html>
  <head>
    <style>

    html,
    body {
        height: 100%;
        width: 100%;
        overflow: hidden;
        box-sizing: border-box;
    }

    body {
        margin: 0;
        background: #fff;
        padding: 60px;
    }

    #logo, #about, #donate, #donate, #pitch, #sofar, #charitylogo, #by {
        position: absolute;
    }

    #logo {
        top: 37px; left: 37px;
    }

    #pitch {
        top: 60px;
        left: 60px;
        right: 60px;
        bottom: 60px;
        background: #368133; /* Old browsers */
        background: -moz-linear-gradient(left, #4dab01 0%, #368133 100%); /* FF3.6-15 */
        background: -webkit-linear-gradient(left, #4dab01 0%,#368133 100%); /* Chrome10-25,Safari5.1-6 */
        background: linear-gradient(to right, #4dab01 0%,#368133 100%); /* W3C, IE10+, FF16+, Chrome26+, Opera12+, Safari7+ */
        filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#368133', endColorstr='#4dab01',GradientType=1 );/*IE6-9 */
    }

    #donate {
        bottom: 37px; left: 37px;
    }

    #about {
        bottom: 37px; left: 107px;
    }

    #sofar {
        bottom: 37px; left: 50%;
        margin-left: -50px;
    }

    #charitylogo {
        bottom: 0px; right: 37px;
    }

    #by {
        bottom: 155px;
        right: -100px;
        -ms-transform: rotate(90deg); /* IE 9 */
        -ms-transform-origin: 0 0; /* IE 9 */
        -webkit-transform: rotate(90deg); /* Chrome, Safari, Opera */
        -webkit-transform-origin: 0 0; /* Chrome, Safari, Opera */
        transform: rotate(90deg);
        transform-origin: 0 0;
    }

    a {
        text-decoration: none;
        color: #333;
    }

    </style>
    <script src="physicsjs-full.js"></script>
    <script src="pixi.js"></script>
  </head>
  <body>
    
    <div id="about">
    About the tournament
    </div>
    <div id="donate">
    Donate now
    </div>
    <div id="sofar">
    £<span>000</span> raised so far for MSF
    </div>
    <div id="pitch">
    </div>
    <div id="logo">
        <img src="assets/IMC-LOGO.png" width=138 height=186 />
    </div>
    <div id="charitylogo">
        <img src="assets/MSF.jpg" width=150 height=53 />
    </div>
    <div id="by">
        site by <a href="http://antipattern.co">antipattern</a>
    </div>


    <script>
    function getQueryVariable(variable) {
       var query = window.location.search.substring(1);
       var vars = query.split("&");
       for (var i=0;i<vars.length;i++) {
               var pair = vars[i].split("=");
               if(pair[0] == variable){return pair[1];}
       }
       return(false);
    }
    var donated = getQueryVariable('donated');
    if(donated && donated === 'true'){
        //alert('thanks for donating');
        document.getElementById('thanks').style.display = "table";
        window.setTimeout(function(){
            $('#thanks').css('display', 'none');
        }, 3000)
    }
    // prevent overscrolling on touch devices
    document.ontouchmove = function(event){
        event.preventDefault();
    }
    Physics(function (world) {
        // bounds of the window
        var viewportBounds = Physics.aabb(0, 0, window.innerWidth-120, window.innerHeight-120),
            edgeBounce,
            renderer

        // create a renderer
        renderer = Physics.renderer('canvas', {
            el: 'pitch',
            width: 2320,
            height: 678
        });

        // add the renderer
        world.add(renderer);
        // render on each step
        world.on('step', function () {
            world.render();
        });

        // constrain objects to these bounds
        edgeBounce = Physics.behavior('edge-collision-detection', {
            aabb: viewportBounds
            ,restitution: 0.4
            ,cof: 0.3
        });

        var resizeId;

        // resize events
        window.addEventListener('resize', function () {
            viewportBounds = Physics.aabb(0, 0, renderer.width, renderer.height);
            edgeBounce.setAABB(viewportBounds);
        }, true);

        var iconWidth = renderer.width > 600 ? 48 : 24;
        var ballWidth = renderer.width > 600 ? 30 : 15;
        // /****************** GOALS *******************/

        var goal1 = Physics.body('rectangle', {
            treatment: 'static'
            ,x: renderer.width > 600 ? 0 : renderer.width/2
            ,y: renderer.width > 600 ? renderer.height * 0.5 : 0
            ,vx: 0.3
            ,width: renderer.width > 600 ? 10 : 150
            ,height: renderer.width > 600 ? 150 : 10
            ,styles: {
                fillStyle: '#fff'
            }
            ,label: "goal1"
        });

        var goal2 = Physics.body('rectangle', {
            treatment: 'static'
            ,x: renderer.width > 600 ? renderer.width : renderer.width/2
            ,y: renderer.width > 600 ? renderer.height * 0.5 : renderer.height
            ,vx: 0
            ,width: renderer.width > 600 ? 10 : 150
            ,height: renderer.width > 600 ? 150 : 10
            ,styles: {
                fillStyle: '#fff'
            }
            ,label: "goal2"
        });
        // /****************** BALL AND PLAYERS *******************/
        var ball = Physics.body('circle', {
            x: renderer.width * 0.5
            ,y: renderer.height * 0.5
            ,vx: 0
            ,vy: 0
            ,radius: ballWidth
            ,styles: {
                fillStyle: '#cb4b16'
            }
            ,mass: 0.2
            ,restitution: 1
            ,label: "ball"
        });

         var player1 = Physics.body('circle', {
            x: renderer.width > 600 ? renderer.width * 0.9 : renderer.width * 0.8
            ,y: renderer.width > 600 ? renderer.height * 0.5 : renderer.height * 0.3
            ,radius: 48
            ,styles: {
                fillStyle: '#000',
                src: 'assets/FABRIC.svg', // could be 80x80... if you want pixel ratio 2
                width: 96,
                height: 96
            }
            ,mass: 1
            ,restitution: 0.1,
        });

        var player2 = Physics.body('circle', {
            x: renderer.width > 600 ? renderer.width * 0.8 : renderer.width * 0.6
            ,y: renderer.width > 600 ? renderer.height * 0.5 : renderer.height * 0.3
            ,radius: 48
            ,styles: {
                fillStyle: '#000',
                src: 'assets/DOMINO.svg', // could be 80x80... if you want pixel ratio 2
                width: 96,
                height: 96
            }
            ,mass: 1
            ,restitution: 0.1,
        });

        var player3 = Physics.body('circle', {
            x: renderer.width > 600 ? renderer.width * 0.7 : renderer.width * 0.4
            ,y: renderer.width > 600 ? renderer.height * 0.5 : renderer.height * 0.3
            ,radius: iconWidth
            ,styles: {
                fillStyle: '#000',
                src: 'assets/NINJA.svg', // could be 80x80... if you want pixel ratio 2
                width: 96,
                height: 96
            }
            ,mass: 1
            ,restitution: 0.1,
        });

        var player4 = Physics.body('circle', {
            x: renderer.width > 600 ? renderer.width * 0.6 : renderer.width * 0.2
            ,y: renderer.width > 600 ? renderer.height * 0.5 : renderer.height * 0.3
            ,radius: iconWidth
            ,styles: {
                fillStyle: '#000',
                src: 'assets/HEAVENLY.svg', // could be 80x80... if you want pixel ratio 2
                width: 96,
                height: 96
            }
            ,mass: 1
            ,restitution: 0.1,
        });

        var player5 = Physics.body('circle', {
            x: renderer.width > 600 ? renderer.width * 0.4 : renderer.width * 0.8
            ,y: renderer.width > 600 ? renderer.height * 0.5 : renderer.height * 0.7
            ,radius: iconWidth
            ,styles: {
                fillStyle: '#000',
                src: 'assets/BELLA-UNION.svg', // could be 80x80... if you want pixel ratio 2
                width: 96,
                height: 96
            }
            ,mass: 1
            ,restitution: 0.1,
        });

        var player6 = Physics.body('circle', {
            x: renderer.width > 600 ? renderer.width * 0.3 : renderer.width * 0.6
            ,y: renderer.width > 600 ? renderer.height * 0.5 : renderer.height * 0.7
            ,radius: iconWidth
            ,styles: {
                fillStyle: '#000',
                src: 'assets/4AD.svg', // could be 80x80... if you want pixel ratio 2
                width: 96,
                height: 96
            }
            ,mass: 1
            ,restitution: 0.1,
        });

        var player7 = Physics.body('circle', {
            x: renderer.width > 600 ? renderer.width * 0.2 : renderer.width * 0.4
            ,y: renderer.width > 600 ? renderer.height * 0.5 : renderer.height * 0.7
            ,radius: iconWidth
            ,styles: {
                fillStyle: '#000',
                src: 'assets/R&S.svg', // could be 80x80... if you want pixel ratio 2
                width: 96,
                height: 96
            }
            ,mass: 1
            ,restitution: 0.1,
        });

        var player8 = Physics.body('circle', {
            x: renderer.width > 600 ? renderer.width * 0.1 : renderer.width * 0.2
            ,y: renderer.width > 600 ? renderer.height * 0.5 : renderer.height * 0.7
            ,radius: iconWidth
            ,styles: {
                fillStyle: '#000',
                src: 'assets/BONAFIDE.svg', // could be 80x80... if you want pixel ratio 2
                width: 96,
                height: 96
            }
            ,mass: 1
            ,restitution: 0.1,
        });

        var player9 = Physics.body('circle', {
            x: renderer.width > 600 ? renderer.width * 0.1 : renderer.width * 0.2
            ,y: renderer.width > 600 ? renderer.height * 0.5 : renderer.height * 0.7
            ,radius: iconWidth
            ,styles: {
                fillStyle: '#000',
                src: 'assets/BRFC.svg', // could be 80x80... if you want pixel ratio 2
                width: 96,
                height: 96
            }
            ,mass: 1
            ,restitution: 0.1,
        });

        var player10 = Physics.body('circle', {
            x: renderer.width > 600 ? renderer.width * 0.1 : renderer.width * 0.2
            ,y: renderer.width > 600 ? renderer.height * 0.5 : renderer.height * 0.7
            ,radius: iconWidth
            ,styles: {
                fillStyle: '#000',
                src: 'assets/LAST-FM.svg', // could be 80x80... if you want pixel ratio 2
                width: 96,
                height: 96
            }
            ,mass: 1
            ,restitution: 0.1,
        });

        var player11 = Physics.body('circle', {
            x: renderer.width > 600 ? renderer.width * 0.1 : renderer.width * 0.2
            ,y: renderer.width > 600 ? renderer.height * 0.5 : renderer.height * 0.7
            ,radius: iconWidth
            ,styles: {
                fillStyle: '#000',
                src: 'assets/RA.svg', // could be 80x80... if you want pixel ratio 2
                width: 96,
                height: 96
            }
            ,mass: 1
            ,restitution: 0.1,
        });

        var player12 = Physics.body('circle', {
            x: renderer.width > 600 ? renderer.width * 0.1 : renderer.width * 0.2
            ,y: renderer.width > 600 ? renderer.height * 0.5 : renderer.height * 0.7
            ,radius: iconWidth
            ,styles: {
                fillStyle: '#000',
                src: 'assets/SECRETLY.svg', // could be 80x80... if you want pixel ratio 2
                width: 96,
                height: 96
            }
            ,mass: 1
            ,restitution: 0.1,
        });

        var player13 = Physics.body('circle', {
            x: renderer.width > 600 ? renderer.width * 0.1 : renderer.width * 0.2
            ,y: renderer.width > 600 ? renderer.height * 0.5 : renderer.height * 0.7
            ,radius: iconWidth
            ,styles: {
                fillStyle: '#000',
                src: 'assets/MIXMAG.svg', // could be 80x80... if you want pixel ratio 2
                width: 96,
                height: 96
            }
            ,mass: 1
            ,restitution: 0.1,
        });

        var player14 = Physics.body('circle', {
            x: renderer.width > 600 ? renderer.width * 0.1 : renderer.width * 0.2
            ,y: renderer.width > 600 ? renderer.height * 0.5 : renderer.height * 0.7
            ,radius: iconWidth
            ,styles: {
                fillStyle: '#000',
                src: 'assets/MUTE.svg', // could be 80x80... if you want pixel ratio 2
                width: 96,
                height: 96
            }
            ,mass: 1
            ,restitution: 0.1,
        });

        var player15 = Physics.body('circle', {
            x: renderer.width > 600 ? renderer.width * 0.1 : renderer.width * 0.2
            ,y: renderer.width > 600 ? renderer.height * 0.5 : renderer.height * 0.7
            ,radius: iconWidth
            ,styles: {
                fillStyle: '#000',
                src: 'assets/PRS.svg', // could be 80x80... if you want pixel ratio 2
                width: 96,
                height: 96
            }
            ,mass: 1
            ,restitution: 0.1,
        });

        var player16 = Physics.body('circle', {
            x: renderer.width > 600 ? renderer.width * 0.1 : renderer.width * 0.2
            ,y: renderer.width > 600 ? renderer.height * 0.5 : renderer.height * 0.7
            ,radius: iconWidth
            ,styles: {
                fillStyle: '#000',
                src: 'assets/VF.svg', // could be 80x80... if you want pixel ratio 2
                width: 96,
                height: 96
            }
            ,mass: 1
            ,restitution: 0.1,
        });


        var hand = Physics.body('circle', {
            x: renderer.width > 600 ? renderer.width * 0.65 : renderer.width * 0.7
            ,y: renderer.width > 600 ? renderer.height * 0.8 : renderer.height * 0.15
            ,radius: iconWidth
            ,angle: renderer.width > 600 ? 0 : -2.5
            ,mass: 1
            ,vx: renderer.width > 600 ? 0 : -0.05
            ,vy: renderer.width > 600 ? -0.15 : 0.1
            ,restitution: 5
        });

        if (renderer.width > 600) {

            //ball.view = new Image();
            //ball.view.src = 'assets/ball.png';
            // hand.view = new Image();
            // hand.view.src = 'assets/hand.png';
            // player1.view = new Image();
            // player1.view.src = 'assets/fabric@2.png';
            // player2.view = new Image();
            // player2.view.src = 'assets/R&S.svg';
            // player3.view = new Image();
            // player3.view.src = 'assets/DOMINO.svg';
            // player4.view = new Image();
            // player4.view.src = 'assets/NINJA.svg';
            // player5.view = new Image();
            // player5.view.src = 'assets/HEAVENLY.svg';
            // player6.view = new Image();
            // player6.view.src = 'assets/BELLA-UNION.svg';
            // player7.view = new Image();
            // player7.view.src = 'assets/HEAVENLY.svg';
            // player8.view = new Image();
            // player8.view.src = 'assets/4AD.svg';
        } else {
            // ball.view = new Image();
            // ball.view.src = 'balls.png';
            // hand.view = new Image();
            // hand.view.src = 'hands.png';
            // player1.view = new Image();
            // player1.view.src = 'balls/fabrics.png';
            // player2.view = new Image();
            // player2.view.src = 'balls/r&ss.png';
            // player3.view = new Image();
            // player3.view.src = 'balls/dominos.png';
            // player4.view = new Image();
            // player4.view.src = 'balls/ninjas.png';
            // player5.view = new Image();
            // player5.view.src = 'balls/heavenlys.png';
            // player6.view = new Image();
            // player6.view.src = 'balls/bella-unions.png';
            // player7.view = new Image();
            // player7.view.src = 'balls/hospitals.png';
            // player8.view = new Image();
            // player8.view.src = 'balls/4ADs.png';
        }
        
        var players = [player1, player2, player3, player4, player5, player6, player7, player8, player9, player10, player11, player12, player13, player14, player15, player16];
        world.add(players);
        world.add([ball, goal1, goal2, edgeBounce]);

        var showhand = window.setTimeout( function(){ world.add(hand); window.setTimeout(function(){ world.remove(hand) }, 3000)}, 5000 );

        var tch = Physics.behavior('interactive', { el: renderer.container }).applyTo( players );
        world.add(tch);
        var accel = Physics.behavior('constant-acceleration').applyTo( ball );
        world.add(accel);
        var resp = Physics.behavior('body-impulse-response').applyTo( players );
        world.add(resp);
        world.add( Physics.behavior('body-collision-detection') );
        world.add( Physics.behavior('sweep-prune') );
        // subscribe to ticker to advance the simulation
        Physics.util.ticker.on(function( time ) {
            world.step( time );
        });
        // query to find a collision between a body with label "bullet" and a body with label "box"
        var query = Physics.query({
            $or: [
                { bodyA: { label: 'ball' }, bodyB: { label: 'goal1' } }
                ,{ bodyB: { label: 'ball' }, bodyA: { label: 'goal1' } }
                ,{ bodyA: { label: 'ball' }, bodyB: { label: 'goal2' } }
                ,{ bodyB: { label: 'ball' }, bodyA: { label: 'goal2' } }
            ]
        });

        world.on('interact:grab', function( data, e ){
            window.clearTimeout(showhand);
        });

        // monitor collisions
        world.on('collisions:detected', function( data, e ){
            var found = Physics.util.find( data.collisions, query );
            if ( found ){
                // SOMEONE SCORED A GOAL!!!!!
                a.play();
                ball.state.pos.x = renderer.width * 0.5;
                ball.state.pos.y = renderer.height * 0.5;
                ball.state.vel.set(0, 0);

                players[0].state.pos.x = renderer.width > 600 ? renderer.width * 0.9 : renderer.width * 0.8
                players[0].state.pos.y = renderer.width > 600 ? renderer.height * 0.5 : renderer.height * 0.3;
                players[0].state.vel.set(0, 0);
                players[1].state.pos.x = renderer.width > 600 ? renderer.width * 0.8 : renderer.width * 0.6
                players[1].state.pos.y = renderer.width > 600 ? renderer.height * 0.5 : renderer.height * 0.3;
                players[1].state.vel.set(0, 0);
                players[2].state.pos.x = renderer.width > 600 ? renderer.width * 0.7 : renderer.width * 0.4
                players[2].state.pos.y = renderer.width > 600 ? renderer.height * 0.5 : renderer.height * 0.3;
                players[2].state.vel.set(0, 0);
                players[3].state.pos.x = renderer.width > 600 ? renderer.width * 0.6 : renderer.width * 0.2
                players[3].state.pos.y = renderer.width > 600 ? renderer.height * 0.5 : renderer.height * 0.3;
                players[3].state.vel.set(0, 0);
                players[4].state.pos.x = renderer.width > 600 ? renderer.width * 0.4 : renderer.width * 0.8
                players[4].state.pos.y = renderer.width > 600 ? renderer.height * 0.5 : renderer.height * 0.7;
                players[4].state.vel.set(0, 0);
                players[5].state.pos.x = renderer.width > 600 ? renderer.width * 0.3 : renderer.width * 0.6
                players[5].state.pos.y = renderer.width > 600 ? renderer.height * 0.5 : renderer.height * 0.7;
                players[5].state.vel.set(0, 0);
                players[6].state.pos.x = renderer.width > 600 ? renderer.width * 0.2 : renderer.width * 0.4
                players[6].state.pos.y = renderer.width > 600 ? renderer.height * 0.5 : renderer.height * 0.7;
                players[6].state.vel.set(0, 0);
                players[7].state.pos.x = renderer.width > 600 ? renderer.width * 0.1 : renderer.width * 0.2
                players[7].state.pos.y = renderer.width > 600 ? renderer.height * 0.5 : renderer.height * 0.7;
                players[7].state.vel.set(0, 0);

                $('#goal').css('display', 'table');
                window.setTimeout(function(){
                    $('#goal').css('display', 'none');
                }, 1800)
            }
        });
    });
    </script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script>
    var a;
    (function($) {
        $.fn.rainbow = function(options) {
            this.each(function() {
                options.originalText = $(this).html();
                options.iterations = 0;
                if (!options.pauseLength) {
                    options.pauseLength = options.animateInterval;
                }
                $(this).data('options',options);
                if (options.pad) {
                    for (x = 0; x < options.originalText.length; x++) {
                        options.colors.unshift(options.colors[options.colors.length-1]);
                    }
                }
                $.fn.rainbow.render(this);      
            });
        }
        $.fn.rainbow.render = function(obj) {
                var options = $(obj).data('options');
                var chars = options.originalText.split('');
                options.iterations++;
                var newstr = '';
                var counter = 0;
                for (var x in chars) {
                    if (chars[x]!=' ') {
                        newstr = newstr + '<span style="color: ' + options.colors[counter] + ';">' + chars[x] + '</span>';
                        counter++;
                    } else {
                        newstr = newstr + ' ';
                    }
                    if (counter >= options.colors.length) {
                        counter = 0;
                    }
                }
                $(obj).html(newstr);
                var pause = (options.iterations % options.colors.length == 0);
                if (options.animate) {(
                        function(obj,interval) {
                            var options = $(obj).data('options');
                            var i = setTimeout(function() {
                                $.fn.rainbow.shift(obj);
                            },interval);
                            options.interval = i;
                            $(obj).data('options',options);
                        }
                    )(obj,pause?options.pauseLength:options.animateInterval);
                }
        }
        $.fn.rainbow.shift = function(obj) {
            var options = $(obj).data('options');
            var color = options.colors.pop();
            options.colors.unshift(color);
            $.fn.rainbow.render(obj);
        }
    })(jQuery);
    $(function() {
        $('#goal div').rainbow({ 
                colors: [
                    '#FF0000',
                    '#f26522',
                    '#fff200',
                    '#00a651',
                    '#28abe2',
                    '#2e3192',
                    '#6868ff'
                ],
                animate: true,
                animateInterval: 100,
                pad: false,
                pauseLength: 100,
            });
        if (donated && donated === 'true') {
            $('#thanks div').rainbow({ 
                colors: [
                    '#FF0000',
                    '#f26522',
                    '#fff200',
                    '#00a651',
                    '#28abe2',
                    '#2e3192',
                    '#6868ff'
                ],
                animate: true,
                animateInterval: 100,
                pad: false,
                pauseLength: 100,
            });
        }

        $.ajax({
            url: "http://api.jo.je/virginmoneygiving/jsonp.php?d=574206&callback=?",
            dataType: 'json',
            success: function(data) {
                var totalTotal = data.money_gift_aid + parseFloat(data.money_total);
                $('.loader').remove();
                $('#totalRaised').html('£' + totalTotal + ' <br />raised');
            }
        });

    });
</script>
<script src="//cdnjs.cloudflare.com/ajax/libs/mobile-detect/1.0.0/mobile-detect.min.js"></script>
<script src="//connect.soundcloud.com/sdk.js"></script>
<script>      
      SC.initialize({
        client_id: "d1cd63a3738d56d1626b58d26cb41069"
      });
      function loopSound(sound) {
        sound.play({
            onfinish: function() {
               loopSound(sound);
            }
        });
      }
      var md = new MobileDetect(window.navigator.userAgent);
      if(!md.mobile()) {
      SC.get("/tracks/68280948", function(track){
          SC.stream(track.uri, function(stream){
            loopSound(stream);
          });
      });
      }
    </script>
    <audio src="AIRHORN.mp3" type="audio/mp3" preload="auto"></audio>
    <script>
    a = document.getElementsByTagName("audio")[0];
    </script>
  </body>
</html>
